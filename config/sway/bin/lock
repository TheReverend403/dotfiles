#!/bin/sh
set -eu

SCREEN_OFF_TIMER=10
BLUR_TYPE="0x6"
SCREENSHOT_TEMP_PATH="${XDG_RUNTIME_DIR}/lockscreen.png"

grim - | convert - -blur "${BLUR_TYPE}" "${SCREENSHOT_TEMP_PATH}"

swayidle \
    timeout "${SCREEN_OFF_TIMER}" 'swaymsg "output * dpms off"' \
    resume 'swaymsg "output * dpms on"' &

swaylock \
    --no-unlock-indicator \
    --image "${SCREENSHOT_TEMP_PATH}"
